<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Concise YANG Telemetry</title>

  
<style type="text/css">/*<![CDATA[*/

body {
  font: 16px "Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 24px;
  margin: 75px auto;
  max-width: 624px;
  padding: 0 5px;
}

.title, .filename, h1, h2, h3, h4, h5 {
  font: 16px "Roboto Condensed","Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  font-size-adjust: 0.5;
  font-weight: bold;
  color: #333;
  line-height: 100%;
  margin: 0.8em 0 0.3em;
}
.title, #rfc\.title h1 { font-size: 32px; }
h1, section h1, h2, section h2, section h3, nav h2 { font-size: 20px; }
h3, section h4, h4, section h5 { font-size: 16px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header, table#rfc\.headerblock {
  width: 100%;
}
table.header td, table#rfc\.headerblock td {
  border: none;
  background-color: transparent;
  color: black;
  padding: 0;
}
.filename {
  display: block;
  color: rgb(119, 119, 119);
  font-size: 20px;
  font-weight: normal;
  line-height: 100%;
  margin: 10px 0 32px;
}
#rfc\.abstract+p, #rfc\.abstract p {
  font-size: 20px;
  line-height: 28px;
}

samp, tt, code, pre {
  font: 15px Consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure, caption {
  font-style: italic;
  margin: 0 1.5em;
  text-align: left;
}

address {
  margin: 16px 2px;
  line-height: 20px;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn, address b {
  font-weight: normal;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}
hr.noprint {
  display: none;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

ol, ul, li, p {
  padding: 0;
  margin: 0.5em 0 0.5em 2em;
}
li, p {
  margin-left: 0;
}
address {
  font-style: normal;
}

ul.toc ul {
  margin: 0 0 0 2em;
}
ul.toc li {
  list-style: none;
  margin: 0;
}

@media screen and (min-width: 924px) {
  body {
    padding-right: 350px;
  }
  body>ul.toc, body>#rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    z-index: 1;
    overflow: auto;
    overscroll-behavior: contain;
  }
  body>#rfc\.toc {
    top: 55px;
  }
  body>ul.toc {
    top: 100px;
  }

  ul.toc {
    margin: 0 0 0 4px;
    font-size: 12px;
    line-height: 20px;
  }
  ul.toc ul {
    margin-left: 1.2em;
  }
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>
  <meta name="viewport" content="initial-scale=1.0">


  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 CoAP Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Summary of the Additions to CoMI">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Telemetry-Specific CoMI datastores">
<link href="#rfc.section.4" rel="Chapter" title="4 Subscription Content and State">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Selection Filter">
<link href="#rfc.section.5" rel="Chapter" title="5 Subscription Characteristics">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Subscription Trigger">
<link href="#rfc.section.5.1.1" rel="Chapter" title="5.1.1 CoMI Configured Subscriptions">
<link href="#rfc.section.5.1.2" rel="Chapter" title="5.1.2 Dynamic Subscriptions">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Subscription Interval">
<link href="#rfc.section.5.2.1" rel="Chapter" title="5.2.1 Periodic Subscription">
<link href="#rfc.section.5.2.2" rel="Chapter" title="5.2.2 On-Change Subscription">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Subscription Type">
<link href="#rfc.section.5.3.1" rel="Chapter" title="5.3.1 Stream Subscription">
<link href="#rfc.section.5.3.2" rel="Chapter" title="5.3.2 Datastore Subscription">
<link href="#rfc.section.6" rel="Chapter" title="6 Subscription Management (better word?)">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 YANG RPCs">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 NETCONF Access Control Model [RFC6536bis]">
<link href="#rfc.section.7" rel="Chapter" title="7 Selection Filters">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 SID for subtree Selection Filter">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 CBOR-YANG for XPATH-like Selection Filter">
<link href="#rfc.section.8" rel="Chapter" title="8 Update Triggers for Periodic Subscriptions">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 Interval">
<link href="#rfc.section.8.2" rel="Chapter" title="8.2 Anchor Time">
<link href="#rfc.section.9" rel="Chapter" title="9 Update Triggers for On-Change Subscriptions">
<link href="#rfc.section.9.1" rel="Chapter" title="9.1 dampening period">
<link href="#rfc.section.9.2" rel="Chapter" title="9.2 change-type">
<link href="#rfc.section.9.3" rel="Chapter" title="9.3 no sync-on-start">
<link href="#rfc.section.10" rel="Chapter" title="10 YANG Push Operations for COMI">
<link href="#rfc.section.10.1" rel="Chapter" title="10.1 Extension of the CoMI Event Stream Resource">
<link href="#rfc.section.10.2" rel="Chapter" title="10.2 Extension of the YANG Subscription Mechanism">
<link href="#rfc.section.11" rel="Chapter" title="11 Upcoming Features and Stories">
<link href="#rfc.section.12" rel="Chapter" title="12 IANA considerations">
<link href="#rfc.section.13" rel="Chapter" title="13 Security Considerations">
<link href="#rfc.section.14" rel="Chapter" title="14 Acknowledgements">
<link href="#rfc.section.15" rel="Chapter" title="15 Change Log">
<link href="#rfc.references" rel="Chapter" title="16 Normative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.9.9 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Birkholz, H. and E. Voit" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-birkholz-yang-comi-push-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2018-04-18" />
  <meta name="dct.abstract" content="This document defines CoAP operations that implement the capabilities of YANG Datastore Subscriptions and YANG Customized Subscriptions for the CoAP Management Interface (CoMI). The '/s' resource, as defined in CoMI, is extended analogously to include a set of sub-resources, each of them representing an observable resource identified by its subscription-id. Specific additions include but are not limited to new FETCH Body definitions and simplified subtree subscriptions to intermediate data nodes in YANG datastore modules using SID." />
  <meta name="description" content="This document defines CoAP operations that implement the capabilities of YANG Datastore Subscriptions and YANG Customized Subscriptions for the CoAP Management Interface (CoMI). The '/s' resource, as defined in CoMI, is extended analogously to include a set of sub-resources, each of them representing an observable resource identified by its subscription-id. Specific additions include but are not limited to new FETCH Body definitions and simplified subtree subscriptions to intermediate data nodes in YANG datastore modules using SID." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">NETCONF Working Group</td>
<td class="right">H. Birkholz</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Fraunhofer SIT</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">E. Voit</td>
</tr>
<tr>
<td class="left">Expires: October 20, 2018</td>
<td class="right">Cisco Systems</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">April 18, 2018</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Concise YANG Telemetry<br />
  <span class="filename">draft-birkholz-yang-comi-push-latest</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document defines CoAP operations that implement the capabilities of YANG Datastore Subscriptions and YANG Customized Subscriptions for the CoAP Management Interface (CoMI). The '/s' resource, as defined in CoMI, is extended analogously to include a set of sub-resources, each of them representing an observable resource identified by its subscription-id. Specific additions include but are not limited to new FETCH Body definitions and simplified subtree subscriptions to intermediate data nodes in YANG datastore modules using SID.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on October 20, 2018.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2018 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">CoAP Terminology</a>
</li>
</ul><li>3.   <a href="#rfc.section.3">Summary of the Additions to CoMI</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">Telemetry-Specific CoMI datastores</a>
</li>
</ul><li>4.   <a href="#rfc.section.4">Subscription Content and State</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Selection Filter</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">Subscription Characteristics</a>
</li>
<ul><li>5.1.   <a href="#rfc.section.5.1">Subscription Trigger</a>
</li>
<ul><li>5.1.1.   <a href="#rfc.section.5.1.1">CoMI Configured Subscriptions</a>
</li>
<li>5.1.2.   <a href="#rfc.section.5.1.2">Dynamic Subscriptions</a>
</li>
</ul><li>5.2.   <a href="#rfc.section.5.2">Subscription Interval</a>
</li>
<ul><li>5.2.1.   <a href="#rfc.section.5.2.1">Periodic Subscription</a>
</li>
<li>5.2.2.   <a href="#rfc.section.5.2.2">On-Change Subscription</a>
</li>
</ul><li>5.3.   <a href="#rfc.section.5.3">Subscription Type</a>
</li>
<ul><li>5.3.1.   <a href="#rfc.section.5.3.1">Stream Subscription</a>
</li>
<li>5.3.2.   <a href="#rfc.section.5.3.2">Datastore Subscription</a>
</li>
</ul></ul><li>6.   <a href="#rfc.section.6">Subscription Management (better word?)</a>
</li>
<ul><li>6.1.   <a href="#rfc.section.6.1">YANG RPCs</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">NETCONF Access Control Model [RFC6536bis]</a>
</li>
</ul><li>7.   <a href="#rfc.section.7">Selection Filters</a>
</li>
<ul><li>7.1.   <a href="#rfc.section.7.1">SID for subtree Selection Filter</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">CBOR-YANG for XPATH-like Selection Filter</a>
</li>
</ul><li>8.   <a href="#rfc.section.8">Update Triggers for Periodic Subscriptions</a>
</li>
<ul><li>8.1.   <a href="#rfc.section.8.1">Interval</a>
</li>
<li>8.2.   <a href="#rfc.section.8.2">Anchor Time</a>
</li>
</ul><li>9.   <a href="#rfc.section.9">Update Triggers for On-Change Subscriptions</a>
</li>
<ul><li>9.1.   <a href="#rfc.section.9.1">dampening period</a>
</li>
<li>9.2.   <a href="#rfc.section.9.2">change-type</a>
</li>
<li>9.3.   <a href="#rfc.section.9.3">no sync-on-start</a>
</li>
</ul><li>10.   <a href="#rfc.section.10">YANG Push Operations for COMI</a>
</li>
<ul><li>10.1.   <a href="#rfc.section.10.1">Extension of the CoMI Event Stream Resource</a>
</li>
<li>10.2.   <a href="#rfc.section.10.2">Extension of the YANG Subscription Mechanism</a>
</li>
</ul><li>11.   <a href="#rfc.section.11">Upcoming Features and Stories</a>
</li>
<li>12.   <a href="#rfc.section.12">IANA considerations</a>
</li>
<li>13.   <a href="#rfc.section.13">Security Considerations</a>
</li>
<li>14.   <a href="#rfc.section.14">Acknowledgements</a>
</li>
<li>15.   <a href="#rfc.section.15">Change Log</a>
</li>
<li>16.   <a href="#rfc.references">Normative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">The YANG management interface for constrained devices and networks, called CoAP Management Interface (CoMI), is defined in <a href="#I-D.ietf-core-comi" class="xref">[I-D.ietf-core-comi]</a> and covers the capabilities as defined by YANG 1.1 <a href="#RFC7950" class="xref">[RFC7950]</a>. The most essential characteristics of CoMI are the use of:</p>
<p></p>

<ul>
<li>the Constrained Application Protocol (CoAP <a href="#RFC7252" class="xref">[RFC7252]</a>) to facilitate an HTTP-esque interaction model,</li>
<li>the Concise Binary Object Representation (CBOR <a href="#RFC7049" class="xref">[RFC7049]</a>) to facilitate an efficient content encoding using <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a>, and</li>
<li>YANG identifier strings are represented as numbers called YANG Schema Item Identifier (SID), also defined in <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a>.</li>
</ul>
<p id="rfc.section.1.p.3">This document defines additions to CoMI called Concise YANG Telemetry that:</p>
<p></p>

<ul>
<li>enrich its capabilities to subscribe to a variety of YANG modeled notifications&#8212;based on YANG Customized Subscriptions to a Publisher's Event Streams <a href="#I-D.ietf-netconf-subscribed-notifications" class="xref">[I-D.ietf-netconf-subscribed-notifications]</a>, and</li>
<li>enable subscriptions to changes data note values in modules provided by the YANG datastore (or parts of them)&#8212;based on YANG Datastore Subscription <a href="#I-D.ietf-netconf-yang-push" class="xref">[I-D.ietf-netconf-yang-push]</a>.</li>
</ul>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.2.p.1">Due to the utilization of CoAP, the interaction model of CoMI is quite similar to RESTCONF <a href="#RFC8040" class="xref">[RFC8040]</a>. RESTCONF supports subscriptions to a YANG datastore via notification statements in YANG modules, which&#8212;when subscribed to via the base subscription YANG RPC defined in <a href="#RFC7950" class="xref">[RFC7950]</a>&#8212;result in Series <a href="#I-D.bormann-t2trg-stp" class="xref">[I-D.bormann-t2trg-stp]</a> of Server Sent Events [W3C.REC-eventsource-20150203]}.  A corresponding Event Stream specification for NETCONF <a href="#RFC6241" class="xref">[RFC6241]</a> Event Notifications is defined in section 3.2.3 of <a href="#RFC5277" class="xref">[RFC5277]</a>. To simplify corresponding terminology (and especially consolidate the impedance mismatch of the terms Notifications and Events), this document defines the following new term:</p>
<p></p>

<dl>
<dt>YANG Telemetry:</dt>
<dd style="margin-left: 8">A Series of YANG Notifications or YANG Notification Bundle Messages that are composed of YANG modeled data, potentially composing update records, sent from a YANG datastore to a YANG client either solicited or unsolicited in a fashion that can guarantee well-defined levels of Visibility with respect to Data Node Value changes.</dd>
</dl>
<p id="rfc.section.2.p.3">Please note: while the focus of YANG is typically on management and operations, the scope of YANG Telemetry extends into the Security Area with respect to Security Events. Because of this, YANG Telemetry characteristics that address security requirements, such as Visibility and Resilient YANG Subscriptions, are addressed in this document.</p>
<p id="rfc.section.2.p.4">The definition of YANG Telemetry is based on the following existing terminology:</p>
<p></p>

<dl>
<dt>Data Node Value:</dt>
<dd style="margin-left: 8">Defined in CoMI as the value assigned to a data node instance. Data node values are serialized into the payload according to the rules defined in section 4 of <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a>.</dd>
<dt>Update Record:</dt>
<dd style="margin-left: 8">A single YANG data item in a Series of YANG Notifications or YANG Notification Bundle Messages conveying the changes to a YANG datastore's module's Data Node Values.</dd>
<dt>Resilient Subscription:</dt>
<dd style="margin-left: 8">A YANG Subscription used to create Concise YANG Telemetry that continues to function in a given scope of CoMI Clients, or discoverable homes (see CoAP Call Home, respectively), if the current receiver of Concise YANG Telemetry is rendered unavailable.</dd>
<dt></dt>
<dd style="margin-left: 8">This subscription characteristic enables a CoMI datastore to detect loss of a specific CoMI Client that is the target of Concise YANG Telemetry, provided that the CoMI Client is part of a group of CoMI Clients that supports this kind of fail-over mechanism. This subscription characteristic can have a deteriorating effect on the level of assurance with respect to Visibility and can therefore result in missed Updated Records, which a "new home" has to be notified about.</dd>
<dt>Series:</dt>
<dd style="margin-left: 8">Series Transfer Pattern are described in <a href="#I-D.bormann-t2trg-stp" class="xref">[I-D.bormann-t2trg-stp]</a> as the conveyance of a sequence of associated data items over time, where a client is able to obtain the Series and to learn about new items.</dd>
<dt></dt>
<dd style="margin-left: 8">YANG Customized Subscriptions or a YANG Datastore Subscription creates an specific Series Transfer Pattern composed of individual YANG Notifications or YANG Notification Bundle Messages that include related updated records.</dd>
<dt>Subscription Characteristics:</dt>
<dd style="margin-left: 8">The set of attributes associated with an active YANG Subscription.</dd>
<dt></dt>
<dd style="margin-left: 8">The set of attributes is defined by the data definition statements <a href="#RFC7950" class="xref">[RFC7950]</a> defined by the augments in YANG Customized Subscriptions to a Publisher's Event Streams <a href="#I-D.ietf-netconf-subscribed-notifications" class="xref">[I-D.ietf-netconf-subscribed-notifications]</a>, YANG Datastore Subscription <a href="#I-D.ietf-netconf-yang-push" class="xref">[I-D.ietf-netconf-yang-push]</a> and corresponding CoAP Tokens for Concise YANG Telemetry.</dd>
<dt>Visibility:</dt>
<dd style="margin-left: 8">A level of assurance that Update Records will be received by a YANG Client.</dd>
<dt></dt>
<dd style="margin-left: 8">There might be reasons, such as resource exhaustion or dampening settings, that result in Update Records being lost in transit or not being emitted by the YANG datastore. Sequential Message-IDs or specific YANG Notifications that report, e.g., about past events of resource exhaustion will inform the YANG Client about the characteristics of the loss of Update Records.</dd>
<dt>YANG Client:</dt>
<dd style="margin-left: 8">Called a YANG-based client or just client in <a href="#RFC7950" class="xref">[RFC7950]</a>, a YANG Client is the entity communicating with a YANG Sever (running potentially multiple YANG datastores) in order to access YANG-defined data.</dd>
<dt></dt>
<dd style="margin-left: 8">YANG Client is a representation agnostic term. Specific network protocols that operate on YANG Servers via YANG Clients use representations, such as XML, JSON, or CBOR.</dd>
<dt>YANG Data Item:</dt>
<dd style="margin-left: 8">An instance of YANG a modules Data Node Values or the changes to Data Node Values, conveyed as data in motion, serialized in a specific representation, such as XML, JSON, or CBOR.</dd>
<dt>YANG Datastore:</dt>
<dd style="margin-left: 8">Defined in <a href="#RFC6241" class="xref">[RFC6241]</a>, a datastore is a conceptual place to store and access information. A datastore might be implemented, for example, using files, a database, flash memory locations, or combinations thereof.</dd>
<dt>YANG Notification:</dt>
<dd style="margin-left: 8">Defined in <a href="#RFC6241" class="xref">[RFC6241]</a>, a Notification is a server-initiated message indicating that a certain event has been recognized by the server.</dd>
<dt></dt>
<dd style="margin-left: 8">While this definition is found in <a href="#RFC6241" class="xref">[RFC6241]</a>, which is based on YANG 1.0 <a href="#RFC6020" class="xref">[RFC6020]</a>, it also applies to the general definition of the YANG Notification statement in YANG 1.1 <a href="#RFC7950" class="xref">[RFC7950]</a>.</dd>
<dt>YANG Notification (Bundle) Message:</dt>
<dd style="margin-left: 8">An encapsulation header for one or more YANG notifications as defined in <a href="#I-D.ietf-netconf-notification-messages" class="xref">[I-D.ietf-netconf-notification-messages]</a>. The message header includes a specific set of well-known objects, which are of potential use to networking layers prior being interpreted by some receiving application layer process.</dd>
<dt></dt>
<dd style="margin-left: 8">Examples of header object include, but are not limited to: timestamps, signatures, or evidence about the integrity of the agents creating messages or notifications.</dd>
<dt>YANG Subscription:</dt>
<dd style="margin-left: 8">A Subscription in the context of YANG is defined in <a href="#RFC5277" class="xref">[RFC5277]</a> NETCONF Event Notification as an agreement and method to receive event notifications over a NETCONF session.  A concept related to the delivery of notifications (if there are any to send) involving destination and selection of notifications.</dd>
<dt></dt>
<dd style="margin-left: 8">In the context of Concise YANG Telemetry, this is a parent term that encompasses the concepts of YANG Datastore Subscriptions, YANG Customized Subscriptions, and traditional subscription to notifications as defined by YANG based network protocols in accordance to YANG 1.1.</dd>
</dl>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#coap-terminology" id="coap-terminology">CoAP Terminology</a>
</h1>
<p id="rfc.section.2.1.p.1">In addition to the illustration of the scope of YANG Telemetry above, this section highlights the most important terms that are vital to the functionality of Concise YANG Telemetry with respect to the Constrained Application Protocol:</p>
<p></p>

<dl>
<dt>CoAP Call Home:</dt>
<dd style="margin-left: 8">A procedure similar to the one defined in <a href="#RFC8071" class="xref">[RFC8071]</a> NETCONF Call Home and RESTCONF Call Home, in which a YANG datastore can trigger a YANG Client to initiate a YANG Subscription (typically by taking on the role of a CoAP client and indicating to a CoAP node that is including a YANG Client to initiate a YANG Subscription).</dd>
<dt>CoAP Requestor:</dt>
<dd style="margin-left: 8">The entity that emits CoAP requests to a CoAP Node with server capabilities.  In the context of Concise YANG Telemetry, a YANG client, for example. that is creating dynamic subscriptions is a CoAP Requestor.</dd>
<dt>CoAP Token:</dt>
<dd style="margin-left: 8">A token used to match a CoAP response with a CoAP request <a href="#RFC7252" class="xref">[RFC7252]</a>. It is intended for use as a client-local identifier to differentiate between concurrent requests (similar to a request ID).</dd>
<dt></dt>
<dd style="margin-left: 8">A CoAP Token must be known, or at least deterministically inferable by a YANG Client in order to receive a Series of CoAP responses that compose Concise YANG Telemetry.</dd>
</dl>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#summary-of-the-additions-to-comi" id="summary-of-the-additions-to-comi">Summary of the Additions to CoMI</a>
</h1>
<p id="rfc.section.3.p.1">This documents defines the binding of YANG Datastore Subscriptions and YANG Customized Subscriptions to the CoAP Management Interface. In summary, these additions include:</p>
<p></p>

<ul>
<li>a CoAP POST operation to create, modify, delete or kill Telemetry subscription state,</li>
<li>a CoAP iPATCH operation to create, modify, delete or kill modify one or more Telemetry subscription states,</li>
<li>a CoAP GET operation including the Observe option to receive a Telemetry stream,</li>
<li>a CoAP FETCH operation including the Observe option to receive multiple Telemetry streams,</li>
<li>an extension of the "/s" resource that includes sub-resource, such as subscription identifiers and corresponding SID instances, and</li>
<li>the capability to direct GET and FETCH operations including the Observe option at resources that are sub-resources of "/c".</li>
</ul>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#telemetry-specific-comi-datastores" id="telemetry-specific-comi-datastores">Telemetry-Specific CoMI datastores</a>
</h1>
<p id="rfc.section.3.1.p.1">The CoMI architecture (and YANG in general) assumes that both YANG client and YANG datastores (server) retain or have access to knowledge about the same YANG specification (see Figure 1 in <a href="#I-D.ietf-core-comi" class="xref">[I-D.ietf-core-comi]</a>). This is not necessarily true for a YANG Push capable CoMI server. Highly constrained nodes can emit Series of subscribed notifications without previous solicitation: this allows them to create well-formed YANG-modeled Telemetry from hard-coded building blocks of YANG-modeled data, which are in compliance to YANG modules. In consequence, while taking on the role of a YANG datastore, a YANG Subscription capable CoMI server SHOULD be capable to process YANG queries, but MAY not be due to the lack of corresponding functions or knowledge of a complete YANG module.</p>
<p id="rfc.section.3.1.p.2">As these flavors of YANG datastores are not necessarily able to create CoMI responses based on client request, it is likely that highly constrained datastores initiate a Call-Home procedure (see <a href="#RFC8071" class="xref">[RFC8071]</a>) acting as if a request was already received (see Configured Subscription above), enticing a very specific request they can fulfill (dynamic subscription) or rendezvous via a discoverable YANG Zero Touch entity. In all these usage scenarios, the datastore intends to create device specific YANG Telemetry to be conveyed to corresponding YANG clients.</p>
<p id="rfc.section.3.1.p.3">In essence, incorporating a complete YANG module on a CoMI datastore that is capable of YANG Subscriptions is not required to enable the initiation of Concise YANG Telemetry within a very specific scope. This kin of Telemetry-Specific CoMI datastore is therefore not a fully YANG 1.1 compliant datastore, but able to create valid YANG modeled YANG Data Items.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#subscription-content-and-state" id="subscription-content-and-state">Subscription Content and State</a>
</h1>
<p id="rfc.section.4.p.1">Two generic YANG notification statements for Update Records are introduced by YANG Datastore Subscriptions <a href="#I-D.ietf-netconf-yang-push" class="xref">[I-D.ietf-netconf-yang-push]</a> augments to enable the following capabilities:</p>
<p></p>

<dl>
<dt>push-update:</dt>
<dd style="margin-left: 8">A notification that includes a complete (and potentially filtered) update of data node values of YANG datastore nodes per the terms of a subscription.</dd>
<dt>push-change-update:</dt>
<dd style="margin-left: 8">A notification that includes an incremental (and potentially filtered) update of data node values of YANG datastore nodes since the last (change-)update notification.</dd>
</dl>
<p id="rfc.section.4.p.3">Every Update Record Notification (Bundle) Message in a Series that is generated in the context of a subscription is emitted per the characteristics of the subscription state maintained by the CoMI datastore. Subscription state can be created on the CoMI datastore during manufacturing, onboarding, enrollment, deployment, or maintenance of the CoMI datastore. Most typically, subscription state is created by a YANG Client (e.g. a Network Management System) via a dynamic subscription.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#selection-filter" id="selection-filter">Selection Filter</a>
</h1>
<p id="rfc.section.4.1.p.1">A vital part of the subscription state that defines the content of a YANG Telemetry stream is the filter expression associated with the subscription characteristics. A filter expression enables a CoMI datastore to emit only a subset of potential notification content; reducing the volume of data in motion, significantly.</p>
<p id="rfc.section.4.1.p.2">Three types of Filter Expressions enable a CoMI datastore to emit filtered subsets of data node value updates:</p>
<p></p>

<dl>
<dt>Subtree Filter Expression:</dt>
<dd style="margin-left: 8">A SID pointing to a specific data node in a YANG module (including notification statements) is used to create update records that include updates about the identified data node and its potential child nodes. Effectively, a single SID points to the root node of the subtree update records are created for.</dd>
<dt>XPATH Filter Expression:</dt>
<dd style="margin-left: 8">A more detailed selection of SIDs and corresponding data node values that update records are created for. The corresponding representation of XPATH Filter Expressions for COMI is defined in <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a>.</dd>
<dt>Conditional SID Selectors (experimental):</dt>
<dd style="margin-left: 8">The SID concept introduced by CoMI and represented via YANG modeled date conveyed using CBOR allows for a simplified Filter Expression data model that retains most of the capabilities of an XPATH Filter Expression, while using a significantly simpler model definition.</dd>
</dl>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#subscription-characteristics" id="subscription-characteristics">Subscription Characteristics</a>
</h1>
<p id="rfc.section.5.p.1">Distinct YANG Telemetry streams are defined by the following three primary subscription characteristics:</p>
<p></p>

<ol>
<li>Subscription Trigger (dynamic / configured)</li>
<li>Subscription Interval (periodic / on-change)</li>
<li>Subscription Type (stream / datastore)</li>
</ol>
<p id="rfc.section.5.p.3">These characteristics define how subscription state is created and how the resulting Telemetry streams behave. In general, corresponding subscription state can be created by a YANG client via the "establish-subscription" RPC as defined in <a href="#I-D.ietf-netconf-subscribed-notifications" class="xref">[I-D.ietf-netconf-subscribed-notifications]</a>.</p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#subscription-trigger" id="subscription-trigger">Subscription Trigger</a>
</h1>
<p id="rfc.section.5.1.p.1">There are three options how to establish a YANG Telemetry stream via YANG Subscriptions:</p>
<p></p>

<ol>
<li>a YANG client starts to receive a Telemetry stream from a YANG datastore, without previous solicitation. To enable this, persistent subscription characteristics must have been configured on the YANG datastore before deployment (e.g. during onboarding), but may be left unknown to the YANG Client.  They then have to be acquired or inferred via procedures that are&#8212;at the time of this writing&#8212;out-of-scope of this document.  In essence, corresponding CoAP Tokens are unknown to the YANG Client when the first YANG Data Item is received from the datastore.</li>
<li>a YANG client starts to receive a Telemetry stream from a YANG datastore, after being solicited to do so. In this case, persistent subscription characteristics are known by a YANG Client and a YANG datastore before deployment or acquired after their deployment. In essence, corresponding CoAP Tokens and Subscription State are already known by the YANG Client and the YANG datastore when the first YANG Data Item is received from the datastore.</li>
<li>a YANG datastore initiates contact with a YANG client via a Rendezvous, Join, or Call Home procedure and triggers the creation of a Telemetry stream by the YANG Client. In this case, the subscription characteristics are provisioned by the YANG Client and come into effect after a YANG datastore successfully discovered the corresponding YANG Client that is its home. In essence, the corresponding CoAP Tokens are created by the CoAP Client and are conveyed to the YANG datastore via the traditional CoAP interaction model.</li>
</ol>
<h1 id="rfc.section.5.1.1">
<a href="#rfc.section.5.1.1">5.1.1.</a> <a href="#comi-configured-subscriptions" id="comi-configured-subscriptions">CoMI Configured Subscriptions</a>
</h1>
<p id="rfc.section.5.1.1.p.1">CoAP defines a strict coupling of request and corresponding response messages via the CoAP Token. Every CoAP Request MUST include a CoAP Token that is generated by the CoAP requestor (client). Analogously, every CoAP response that is associated with that request MUST include the corresponding CoAP Token in order for the CoAP Request not to be discarded.</p>
<p id="rfc.section.5.1.1.p.2">In order to enable this type of YANG Subscription, one or more CoMI Clients have to retain or gain knowledge about the corresponding CoAP Tokens (via declarative guidance, a distribution mechanism, or by inferring them via a Call Home procedure), for which they are intended to receive Concise YANG Telemetry by. This implies the existence of a deployed solution that enables a secure and resilient distribution of corresponding CoAP Tokens in a group of CoMI Clients. The exact architecture of this solution is&#8212;at the time of this writing&#8212;out-of-scope of this document.</p>
<h1 id="rfc.section.5.1.2">
<a href="#rfc.section.5.1.2">5.1.2.</a> <a href="#dynamic-subscriptions" id="dynamic-subscriptions">Dynamic Subscriptions</a>
</h1>
<p id="rfc.section.5.1.2.p.1">This subscription trigger requires knowledge about potential YANG datastores to subscribe to by a YANG Client. This subscription characteristics have to be pre-configured or discoverable by the YANG Client. A typical procedure to facilitate a dynamic subscription is the Call Home discovery mechanism.</p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#subscription-interval" id="subscription-interval">Subscription Interval</a>
</h1>
<p id="rfc.section.5.2.p.1">The subscription interval is a specific Subscription Characteristic that defines the events that trigger emission of an Update Record in the context of a YANG Subscription. There are two types of subscription interval: periodic subscription and on-change subscription.</p>
<h1 id="rfc.section.5.2.1">
<a href="#rfc.section.5.2.1">5.2.1.</a> <a href="#periodic-subscription" id="periodic-subscription">Periodic Subscription</a>
</h1>
<p id="rfc.section.5.2.1.p.1">A periodic subscription uses a timer in order to emit an Update Record in the context of a YANG Subscription. This type of Subscription Characteristic is intended to be used if Data Node Values change rapidly or continuously. A typically example of Data Node Values that benefit from this type of Subscription Characteristic is used are PDU Counters.</p>
<h1 id="rfc.section.5.2.2">
<a href="#rfc.section.5.2.2">5.2.2.</a> <a href="#on-change-subscription" id="on-change-subscription">On-Change Subscription</a>
</h1>
<p id="rfc.section.5.2.2.p.1">An on-change subscription uses the event of a Data Node Value change to emit an Update Record in the context of a YANG Subscription. This type of Subscription Characteristic is intended to be used if Data Node Values changes only occasionally, but conveyance of information about that change in a timely fashion is required.  Typical examples are, deployment of a new IEEE 802.1AR LDevID, or the modification of an ACL by a logged in user.</p>
<h1 id="rfc.section.5.2.2.1">
<a href="#rfc.section.5.2.2.1">5.2.2.1.</a> <a href="#on-change-subscription-prerequisites" id="on-change-subscription-prerequisites">On-Change Subscription Prerequisites</a>
</h1>
<p id="rfc.section.5.2.2.1.p.1">An on-change subscription capability MUST be explicitly annotated in a YANG module definition in order to prevent a meaningless or harmful association of Subscription Characteristics to a YANG Subscription. E.g. it is advisable not to allow for on-change subscriptions to data definition statements that provide Data Node Values representing rapidly changing counters.</p>
<p id="rfc.section.5.2.2.1.p.2">The actual syntax and corresponding semantics of data definition statements that are intended to allow for associating an on-change Subscription Characteristic with a YANG Datastore Subscription to a YANG module is out-of-scope of <a href="#I-D.ietf-netconf-yang-push" class="xref">[I-D.ietf-netconf-yang-push]</a> or <a href="#I-D.ietf-netconf-subscribed-notifications" class="xref">[I-D.ietf-netconf-subscribed-notifications]</a> and&#8212;in consequence&#8212;also out-of-scope of this document.</p>
<h1 id="rfc.section.5.2.2.2">
<a href="#rfc.section.5.2.2.2">5.2.2.2.</a> <a href="#visibility" id="visibility">Visibility</a>
</h1>
<p id="rfc.section.5.2.2.2.p.1">In usage scenarios that require a high level of assurance with respect to Visibility (most prominently security-related events) it is vital for a YANG Client to gain knowledge about a deterioration of Visibility of Update Records.</p>
<p id="rfc.section.5.2.2.2.p.2">In order to request complete Visibility of every Data Node Value change via a corresponding Update Record, the dampening-period (see section 4.2. in <a href="#I-D.ietf-netconf-yang-push" class="xref">[I-D.ietf-netconf-yang-push]</a> MUST be set to 0. The use of YANG Notification Bundle Messages <a href="#I-D.ietf-netconf-notification-messages" class="xref">[I-D.ietf-netconf-notification-messages]</a> can mitigate the deteriorating impact of a dampening-period higher than 0, but can still result in missed Update Records in an constrained-node environment.</p>
<p id="rfc.section.5.2.2.2.p.3">If the conveyance of an Update Record (bundled or not) failed, the YANG datastore MUST include an "updates-not-sent" flag in the next Update Record.</p>
<p id="rfc.section.5.2.2.2.p.4">There are usage scenarios, in which complete Visibility of every Change to Data Node Values, but only the information that there was a Data Node Values change occurred is appropriate. In these cases, a dampening-period higher than 0 should be used. A prominent example are "interface-flapping" events.</p>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> <a href="#subscription-type" id="subscription-type">Subscription Type</a>
</h1>
<p id="rfc.section.5.3.p.1">The YANG Push subscription trigger mechanisms illustrated above create subscription state between a YANG client and a YANG datastore. As long as this subscription state between these two entities persists, a datastore can emit series of YANG notifications to a YANG client, if appropriate conditions are met, e.g. the YANG client expects solicited event notifications coming from the datastore due to a dynamic subscription.</p>
<p id="rfc.section.5.3.p.2">YANG Push <a href="#I-D.ietf-netconf-yang-push" class="xref">[I-D.ietf-netconf-yang-push]</a> and YANG Subscribed Notifications <a href="#I-D.ietf-netconf-subscribed-notifications" class="xref">[I-D.ietf-netconf-subscribed-notifications]</a> extend this mechanism by enabling subscriptions to changes of YANG module data node state in a YANG datastore resulting in two types of sources - or two different types of YANG Notification Series [-cabo-series], respectively:</p>
<p></p>

<ul>
<li>event stream telemetry</li>
<li>datastore changes telemetry</li>
</ul>
<h1 id="rfc.section.5.3.1">
<a href="#rfc.section.5.3.1">5.3.1.</a> <a href="#stream-subscription" id="stream-subscription">Stream Subscription</a>
</h1>
<h1 id="rfc.section.5.3.2">
<a href="#rfc.section.5.3.2">5.3.2.</a> <a href="#datastore-subscription" id="datastore-subscription">Datastore Subscription</a>
</h1>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#subscription-management-better-word" id="subscription-management-better-word">Subscription Management (better word?)</a>
</h1>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#yang-rpcs" id="yang-rpcs">YANG RPCs</a>
</h1>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> <a href="#netconf-access-control-model-rfc6536bis" id="netconf-access-control-model-rfc6536bis">NETCONF Access Control Model [RFC6536bis]</a>
</h1>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#selection-filters" id="selection-filters">Selection Filters</a>
</h1>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> <a href="#sid-for-subtree-selection-filter" id="sid-for-subtree-selection-filter">SID for subtree Selection Filter</a>
</h1>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> <a href="#cbor-yang-for-xpath-like-selection-filter" id="cbor-yang-for-xpath-like-selection-filter">CBOR-YANG for XPATH-like Selection Filter</a>
</h1>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#update-triggers-for-periodic-subscriptions" id="update-triggers-for-periodic-subscriptions">Update Triggers for Periodic Subscriptions</a>
</h1>
<h1 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> <a href="#interval" id="interval">Interval</a>
</h1>
<h1 id="rfc.section.8.2">
<a href="#rfc.section.8.2">8.2.</a> <a href="#anchor-time" id="anchor-time">Anchor Time</a>
</h1>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#update-triggers-for-on-change-subscriptions" id="update-triggers-for-on-change-subscriptions">Update Triggers for On-Change Subscriptions</a>
</h1>
<h1 id="rfc.section.9.1">
<a href="#rfc.section.9.1">9.1.</a> <a href="#dampening-period" id="dampening-period">dampening period</a>
</h1>
<p></p>

<ul>
<li>requires bundled messages, in order to maintain visibility</li>
<li>applies to update record creation, not transmission</li>
</ul>
<h1 id="rfc.section.9.2">
<a href="#rfc.section.9.2">9.2.</a> <a href="#change-type" id="change-type">change-type</a>
</h1>
<p></p>

<ul><li>create, delete, change (where is the complete list?)</li></ul>
<h1 id="rfc.section.9.3">
<a href="#rfc.section.9.3">9.3.</a> <a href="#no-sync-on-start" id="no-sync-on-start">no sync-on-start</a>
</h1>
<p></p>

<ul><li>full set at start of sub is omitted</li></ul>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#yang-push-operations-for-comi" id="yang-push-operations-for-comi">YANG Push Operations for COMI</a>
</h1>
<p id="rfc.section.10.p.1">Every subscription-id is created by the YANG datastore and is used in the corresponding subscription state to provide the root identifier, by which dedicated subscription characteristics are associated with an established subscription. In consequence, the basic interaction model of Concise YANG Push is split into two operations that are initiated by the YANG client in sequence:</p>
<p></p>

<ul>
<li>a POST operation on /c executing the establish-subscription RPC corresponding to the included request body with content-type "application/yang-value+cbor" that returns the subscription-id (or an error response) in an "application/yang-value+cbor" response</li>
<li>a GET Observe operation on the event stream resource /s/subscription-id or a FETCH operation on /s including a FETCH body with content-format "application/yang-selectors+cbor" and one or more subscription-id as content.</li>
</ul>
<h1 id="rfc.section.10.1">
<a href="#rfc.section.10.1">10.1.</a> <a href="#extension-of-the-comi-event-stream-resource" id="extension-of-the-comi-event-stream-resource">Extension of the CoMI Event Stream Resource</a>
</h1>
<p id="rfc.section.10.1.p.1">A standard CoMI datastore as defined in <a href="#I-D.ietf-core-comi" class="xref">[I-D.ietf-core-comi]</a> typically uses the datastore resource "/c" to provide the YANG datastore tree and the resource "/s" to provide the YANG notification stream. Sub-resources under "/c" are represented in the format of /c/sid.</p>
<p id="rfc.section.10.1.p.2">CoMI Push extends the scope of the "/s" resource. Sub-resources under "/s" are represented as /s/key, where key is a numeric string representation of the subscription identifier, e.g. "/s/65536/". The key representation reduces the ambiguity with respect to sid, which uses an URI safe base64 representation.</p>
<p id="rfc.section.10.1.p.3">Under each subscription identifier key provided as a sub-resource of the "/s" resource, a YANG tree instance of the subscription characteristics yang:ietf-subscribed-notifications/subscriptions (as defined in YANG Push <a href="#I-D.ietf-netconf-yang-push" class="xref">[I-D.ietf-netconf-yang-push]</a>, which augments ietf-subscribed-notification defined in <a href="#I-D.ietf-netconf-subscribed-notifications" class="xref">[I-D.ietf-netconf-subscribed-notifications]</a>) is provided. In the following example every sid is illustrated as a "string" as there is no sid for corresponding instance identifiers yet:</p>
<p id="rfc.section.10.1.p.4">/s/"65536"/"stream"/"within-subscription"/"filter-spec"/"stream-xpath-filter"/"stream-xpath-filter"</p>
<p id="rfc.section.10.1.p.5">This example would point to the filter selection associated with subscription id 65536.</p>
<h1 id="rfc.section.10.2">
<a href="#rfc.section.10.2">10.2.</a> <a href="#extension-of-the-yang-subscription-mechanism" id="extension-of-the-yang-subscription-mechanism">Extension of the YANG Subscription Mechanism</a>
</h1>
<p id="rfc.section.10.2.p.1">YANG Push provides augmented RPC for establishing, modifying, deleting, or killing a subscription. CoMI uses the same module as YANG Push and provides a corresponding interface to allow for a corresponding confirmable POST message to RPC resources (see <a href="#I-D.ietf-core-comi" class="xref">[I-D.ietf-core-comi]</a> Section 5.3.2.).</p>
<p id="rfc.section.10.2.p.2">CoMI Push also defines the capabilities to point confirmable FETCH messages &#8211; including the Observe option - to sub-resources provided by "/c". If the body of the FETCH message includes a CBOR modeled <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a> subtree filter expression, a new subscription is created and a corresponding subscription id is returned. Additionally, a corresponding subscription sub-resource under "/s" is created.</p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> <a href="#upcoming-features-and-stories" id="upcoming-features-and-stories">Upcoming Features and Stories</a>
</h1>
<p></p>

<ul>
<li>maybe we should introduce /sn and /snmb for stream subscriptions and</li>
<li>SIDs and subscription-id have to be both "the same" and "distinguishable" from sid <ul><li>maybe we have to create a new content-format application/yang-subest+cbor and application/yang-subres+cbor?</li></ul>
</li>
<li>my resource goes away during subscription (e.g. FRU pulled)</li>
<li>back channel liveness check - important for udp and sudden outage in telemetry flows</li>
</ul>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> <a href="#iana-considerations" id="iana-considerations">IANA considerations</a>
</h1>
<p id="rfc.section.12.p.1">This document includes no requests to IANA, but solutions drafts incubated via this document might.</p>
<h1 id="rfc.section.13">
<a href="#rfc.section.13">13.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p id="rfc.section.13.p.1">This document includes no security considerations, but solution drafts incubated via this document will.</p>
<h1 id="rfc.section.14">
<a href="#rfc.section.14">14.</a> <a href="#acknowledgements" id="acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.14.p.1">Carsten Bormann, Klaus Hartke, Michel Veillette</p>
<h1 id="rfc.section.15">
<a href="#rfc.section.15">15.</a> <a href="#change-log" id="change-log">Change Log</a>
</h1>
<p id="rfc.section.15.p.1">First version -00</p>
<h1 id="rfc.references">
<a href="#rfc.references">16.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.bormann-t2trg-stp">[I-D.bormann-t2trg-stp]</b></td>
<td class="top">
<a>Bormann, C.</a> and <a>K. Hartke</a>, "<a href="https://tools.ietf.org/html/draft-bormann-t2trg-stp-01">The Series Transfer Pattern (STP)</a>", Internet-Draft draft-bormann-t2trg-stp-01, July 2018.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-comi">[I-D.ietf-core-comi]</b></td>
<td class="top">
<a>Veillette, M.</a>, <a>Stok, P.</a>, <a>Pelov, A.</a> and <a>A. Bierman</a>, "<a href="https://tools.ietf.org/html/draft-ietf-core-comi-03">CoAP Management Interface</a>", Internet-Draft draft-ietf-core-comi-03, June 2018.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-yang-cbor">[I-D.ietf-core-yang-cbor]</b></td>
<td class="top">
<a>Veillette, M.</a>, <a>Pelov, A.</a>, <a>Somaraju, A.</a>, <a>Turner, R.</a> and <a>A. Minaburo</a>, "<a href="https://tools.ietf.org/html/draft-ietf-core-yang-cbor-06">CBOR Encoding of Data Modeled with YANG</a>", Internet-Draft draft-ietf-core-yang-cbor-06, February 2018.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-netconf-notification-messages">[I-D.ietf-netconf-notification-messages]</b></td>
<td class="top">
<a>Voit, E.</a>, <a>Birkholz, H.</a>, <a>Bierman, A.</a>, <a>Clemm, A.</a> and <a>T. Jenkins</a>, "<a href="https://tools.ietf.org/html/draft-ietf-netconf-notification-messages-03">Notification Message Headers and Bundles</a>", Internet-Draft draft-ietf-netconf-notification-messages-03, February 2018.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-netconf-subscribed-notifications">[I-D.ietf-netconf-subscribed-notifications]</b></td>
<td class="top">
<a>Voit, E.</a>, <a>Clemm, A.</a>, <a>Prieto, A.</a>, <a>Nilsen-Nygaard, E.</a> and <a>A. Tripathy</a>, "<a href="https://tools.ietf.org/html/draft-ietf-netconf-subscribed-notifications-13">Customized Subscriptions to a Publisher's Event Streams</a>", Internet-Draft draft-ietf-netconf-subscribed-notifications-13, June 2018.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-netconf-yang-push">[I-D.ietf-netconf-yang-push]</b></td>
<td class="top">
<a>Clemm, A.</a>, <a>Voit, E.</a>, <a>Prieto, A.</a>, <a>Tripathy, A.</a>, <a>Nilsen-Nygaard, E.</a>, <a>Bierman, A.</a> and <a>B. Lengyel</a>, "<a href="https://tools.ietf.org/html/draft-ietf-netconf-yang-push-17">YANG Datastore Subscription</a>", Internet-Draft draft-ietf-netconf-yang-push-17, July 2018.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5277">[RFC5277]</b></td>
<td class="top">
<a>Chisholm, S.</a> and <a>H. Trevino</a>, "<a href="https://tools.ietf.org/html/rfc5277">NETCONF Event Notifications</a>", RFC 5277, DOI 10.17487/RFC5277, July 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6020">[RFC6020]</b></td>
<td class="top">
<a>Bjorklund, M.</a>, "<a href="https://tools.ietf.org/html/rfc6020">YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)</a>", RFC 6020, DOI 10.17487/RFC6020, October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6241">[RFC6241]</b></td>
<td class="top">
<a>Enns, R.</a>, <a>Bjorklund, M.</a>, <a>Schoenwaelder, J.</a> and <a>A. Bierman</a>, "<a href="https://tools.ietf.org/html/rfc6241">Network Configuration Protocol (NETCONF)</a>", RFC 6241, DOI 10.17487/RFC6241, June 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7049">[RFC7049]</b></td>
<td class="top">
<a>Bormann, C.</a> and <a>P. Hoffman</a>, "<a href="https://tools.ietf.org/html/rfc7049">Concise Binary Object Representation (CBOR)</a>", RFC 7049, DOI 10.17487/RFC7049, October 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7252">[RFC7252]</b></td>
<td class="top">
<a>Shelby, Z.</a>, <a>Hartke, K.</a> and <a>C. Bormann</a>, "<a href="https://tools.ietf.org/html/rfc7252">The Constrained Application Protocol (CoAP)</a>", RFC 7252, DOI 10.17487/RFC7252, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7950">[RFC7950]</b></td>
<td class="top">
<a>Bjorklund, M.</a>, "<a href="https://tools.ietf.org/html/rfc7950">The YANG 1.1 Data Modeling Language</a>", RFC 7950, DOI 10.17487/RFC7950, August 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8040">[RFC8040]</b></td>
<td class="top">
<a>Bierman, A.</a>, <a>Bjorklund, M.</a> and <a>K. Watsen</a>, "<a href="https://tools.ietf.org/html/rfc8040">RESTCONF Protocol</a>", RFC 8040, DOI 10.17487/RFC8040, January 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8071">[RFC8071]</b></td>
<td class="top">
<a>Watsen, K.</a>, "<a href="https://tools.ietf.org/html/rfc8071">NETCONF Call Home and RESTCONF Call Home</a>", RFC 8071, DOI 10.17487/RFC8071, February 2017.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Henk Birkholz</span> 
	  <span class="n hidden">
		<span class="family-name">Birkholz</span>
	  </span>
	</span>
	<span class="org vcardline">Fraunhofer SIT</span>
	<span class="adr">
	  <span class="vcardline">Rheinstrasse 75</span>

	  <span class="vcardline">
		<span class="locality">Darmstadt</span>,  
		<span class="region"></span>
		<span class="code">64295</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:henk.birkholz@sit.fraunhofer.de">henk.birkholz@sit.fraunhofer.de</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Eric Voit</span> 
	  <span class="n hidden">
		<span class="family-name">Voit</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:evoit@cisco.com">evoit@cisco.com</a></span>

  </address>
</div>

</body>
</html>
